# 将语音识别添加到您的嵌入式平台。

> 原文:[https://hack aday . com/2010/07/11/adding-speach-recognition-to-your-embedded-platform/](https://hackaday.com/2010/07/11/adding-speach-recognition-to-your-embedded-platform/)

 <https://www.youtube.com/embed/OEUeJb6Pwt4?version=3&rel=1&showsearch=0&showinfo=1&iv_load_policy=1&fs=1&hl=en-US&autohide=2&wmode=transparent>

</span> <p>上周，我们发布了一个关于如何在初级水平配置语音识别的故事。一些评论者表达了对嵌入式设备语音识别的兴趣。[Nickolay Shmyrev]自愿为那些人写一些说明。在本文中，[Nickolay]将带您了解使用<a href="http://cmusphinx.sourceforge.net/" target="_blank"> CMUsphinx </a>语音识别开源工具包设置嵌入式设备的基础知识。他用 C 和 python 给出了编程示例。虽然我们主持这个，我们还没有设置和尝试它，所以请直接在评论中对[Nickolay]有任何问题。<br/> <span id="more-25898"/> <br/>这里我们将考虑如何使用 CMUSphinx 项目的<br/> <a href="http://cmusphinx.sourceforge.net" target="_blank"> Pocketsphinx 库实现语音识别功能</a></p> <p>使用 Pocketsphinx 的优点是:</p> <ul> <li>Pocketsphinx 是资源高效的。它可以完美地运行在嵌入式平台上。虽然不限于此，但是您可以在您的桌面/服务器上使用 pocketsphinx。Pocketsphinxvhas 只支持定点算法，因此可以在没有 FPU 的情况下运行。它还针对一些流行的平台进行了优化:Blackfin、Maemo、IPhone。</li> <li>Pocketsphinx 支持许多现成的语言。它支持美国英语，中文，法语，俄语，德语，荷兰语等，而不需要培训什么。</li> <li>Pocketsphinx 是完全免费的软件。</li> <li>提供了几种编程语言的可用绑定。</li> </ul> <p>所以 Pocketsphinx 真的是你语音识别库的最佳选择。</p> <p>在你开始编程语音界面之前，有几件事你需要知道</p> <ul> <li>语音识别器要求你指定他们将理解的单词(所谓的语法)，除了指定的语言，他们不会理解任何其他东西。</li> <li>语音本质上是不准确的，你需要把它放在语音界面设计的角落里。识别器返回识别文本的置信度值。确保使用这个置信度值来拒绝不可靠的结果。如果识别器没有信心，尝试再次输入文本，询问附加信息，确认用户意图。</li> <li>语音识别库的任务不是进行声音输入。音频接口通常是特定于设备的。您需要在应用程序中录制音频，并将其转换为特殊格式——PCM、单声道、8kHz、16 位。再次确认。如果你有 mp3，转换一下。如果您有 44.1kHz 的音频，请对其进行下采样。</li> </ul> <p>让我们从简单的测试开始。一旦安装了 Pocketsphinx，只需不带任何参数运行 Pocketsphinx_continuous <br/>即可。等到</p> <p>准备好了…</p> <p>会出现在终端上然后说些什么。Pocketsphinx 将从您的麦克风记录音频并输出识别结果。</p> <p>000000001:你好(-11998485)</p> <p>你没能让它识别你好？别担心，有些人发现产生识别结果的是命运之手。算你运气好。</p> <p>现在让我们尝试学习如何指定语法，Pocketsphinx 将识别的语言。使用以<a href="http://java.sun.com/products/java-media/speech/forDevelopers/JSGF/" target="_blank"> JSGF 格式</a>编写的语法文件来完成。</p> <p>这是相当简单的人类可读的文本格式，也许最好从示例开始:</p> <p># JSGF V1.0<br/>语法 goforward<br/>公共&lt;移动&gt; =前进&lt;方向&gt; &lt;距离&gt;【米|米】；<br/> &lt;方向&gt; =向前|向后；<br/> &lt;距离&gt; =(一|二|三|四|五|六|七|八|九|十|二十)+；</p> <p>你可以看到它可以指定替代，重复和跳过。JSGF 基本上描述了识别器的有限状态自动化。你的语法越严格，识别的准确性就越好。但是不要忘记在真正的语法中包括所有那些填充符<br/>和错误的开始。用户不会对设备说</p> <p>"意大利香肠披萨"</p> <p>他们会说</p> <p>“我想要，让我想想……三个意大利香肠比萨饼，不……洋葱比萨饼”</p> <p>你的语法应该涵盖这一点。一旦你创建了你的语法，将其存储为<br/> grammar.jsgf。另外，以 8khz 单声道录制音频文件，并将其命名为“myrecording.wav”。</p> <p>现在，让我们做一些编程。为了演示如何创建语音识别应用程序，让我们首先尝试将 Pocketsphinx 与 Python 结合使用。Python API 非常简单，示例只有 6 行代码。要识别语音，你需要完成三个步骤，它们是:</p> <p>#!/usr/bin/python</p> <p>#第一步，初始化<br/>导入 pocketsphinx 为 ps <br/>解码器= ps。解码器(jsgf = '/path/to/your/jsgf/grammar . jsgf '，samp rate = ' 8000 ')<br/>#第二步，打开音频文件。<br/> fh = open("myrecording.wav "，" Rb ")<br/>nsamp = decoder . decode _ raw(FH)<br/>#第三步，获取结果<br/> hyp，uttid，score = decoder . get _ hyp()<br/>print " Got result % s % d " %(hyp，score)</p> <p>现在，让我们用 c 做同样的事情。它与 python 并没有真正的不同，只是更适合你的设备。</p> <p>#包括<pocketsphinx.h/></p> <p>int <br/> main(int argc，char * argv[])<br/>{<br/>PS _ decoder _ t * PS；<br/>cmd _ ln _ t * config；<br/>FILE * FH；<br/> char const *hyp，* uttid<br/>int 16 buf[512]；<br/>int RV；<br/> int32 评分；</p> <p>/*配置的初始化*/ <br/> config = cmd_ln_init(NULL，ps_args()，TRUE，<br/> "-samprate "，" 8000 "，<br/> "-jsgf "，" test.jsgf "，<br/>NULL)；<br/>PS = PS _ init(config)；</p> <p>/*打开音频文件，开始馈入解码器*/<br/>FH = fopen(" my recording . wav "，" Rb ")；<br/> rv = ps_start_utt(ps，" go forward ")；<br/> while(！feof(FH)){<br/>size _ t nsamp；<br/> nsamp = fread(buf，2512，FH)；<br/> rv = ps_process_raw(ps，buf，nsamp，FALSE，FALSE)；<br/>}<br/>RV = PS _ end _ utt(PS)；</p> <p>/*获取结果并打印*/ <br/> hyp = ps_get_hyp(ps，&amp; score，&amp;uttid)；<br/> if (hyp == NULL) <br/>返回 1；<br/> printf("已识别:%s with prob %d\n "，hyp，ps_get_prob (ps，NULL))；</p> <p>/* Free the stuff */<br/>f close(FH)；<br/>PS _ free(PS)；<br/>返回 0；<br/> }</p> <p>在 Linux 上，用简单的命令行编译演示:</p> <p>gcc ' pkg-config pocket sphinx–cflags–libs ' demo . c-o demo</p> <p>然后跑</p> <p>。/演示</p> <p>如果有效，它就可以被包含到您的设备中。阅读 API 指南中关于 Pocketsphinx 函数<br/>的更多信息:</p> <p><a href="http://cmusphinx.sourceforge.net/api/pocketsphinx/" rel="nofollow" target="_blank">http://cmusphinx.sourceforge.net/api/pocketsphinx/</a></p> <p>完成基本示例后，就该使用 Pocketsphinx 构建应用程序了。当你设计它的时候，解放你的思想，不要只关注像“开灯”这样简单的命令。现代应用包括智能逻辑分析、连续听写支持和许多其他东西。尝试变得合理，设计你的界面和语法，考虑用户和你的演讲<br/>应用将会成功。</p> <p>还是不相信能行？查看演示 pocketsphinx 在诺基亚 N800 上运行的视频(在帖子顶部)。有关 Pocketsphinx、CMUSphinx 项目、语音识别的更多详情，请访问<a href="http://cmusphinx.sourceforge.net" rel="nofollow" target="_blank">http://cmusphinx.sourceforge.net</a></p> <div id="_mcePaste" style="position:absolute;left:-10000px;top:2811px;width:1px;height:1px;overflow:hidden;">Adding speech recognition feature to your device <p>这里我们将考虑如何使用 CMUSphinx 项目(<a href="http://cmusphinx.sourceforge.net" rel="nofollow" target="_blank">http://cmusphinx.sourceforge.net</a>)的<br/> Pocketsphinx 库实现语音识别功能</p> <p>使用 Pocketsphinx 的优点是:</p> <p>* Pocketsphinx 是资源高效的。它可以完美地运行在嵌入式平台上<br/>虽然不限于这些平台，但是你可以在你的桌面/服务器上使用 pocketsphinx。Pocketsphinx <br/>只支持定点算法，因此可以在没有 FPU 的情况下运行。这也是优化<br/>对一些流行的平台:Blackfin，Maemo，IPhone。<br/> * Pocketsphinx 支持多种现成语言。它支持美国英语，中文，法语，俄语，德语，荷兰语等，而不需要培训什么。<br/> * Pocketsphinx 是完全免费的软件。<br/> *提供多种编程语言的可用绑定。</p> <p>所以 Pocketsphinx 真的是你语音识别库的最佳选择。</p> <p>在你开始编程语音界面之前，有几件事你需要知道</p> <p>*语音识别器要求您指定他们将理解的单词(所谓的语法)，除了指定的语言，他们不会理解任何其他东西。<br/> *语音天生就是不准确的，你需要把这个放在语音界面设计的角落里。<br/>识别器返回你所识别文本的置信度值。确保使用这个置信度<br/>值拒绝不可靠的结果。如果识别器不自信，再次尝试输入文本，<br/>询问附加信息，确认用户意图。<br/> *语音识别库的任务不是做声音输入。音频接口<br/>通常是特定于设备的。您需要在您的应用程序中录制音频，并将其转换为特殊的<br/>格式——PCM、单声道、8kHz、16 位。再次确认。如果你有 mp3，转换一下。如果您有 44.1kHz 的<br/>音频，请对其进行降采样。</p> <p>让我们从简单的测试开始。一旦安装了 Pocketsphinx，只需不带任何参数运行 Pocketsphinx_continuous <br/>即可。等到</p> <p>准备好了…</p> <p>会出现在终端上然后说些什么。Pocketsphinx 将从您的麦克风记录音频并输出识别结果。</p> <p>000000001:你好(-11998485)</p> <p>你没能让它识别你好？别担心，有些人发现产生识别结果的是命运之手。算你运气好。</p> <p>现在让我们尝试学习如何指定语法，Pocketsphinx 将识别的语言。这是用 JSGF 格式的语法文件完成的。</p> <p><a href="http://java.sun.com/products/java-media/speech/forDevelopers/JSGF/" rel="nofollow" target="_blank">http://Java . sun . com/products/Java-media/speech/for developers/JSGF/</a></p> <p>这是相当简单的人类可读的文本格式，也许最好从示例开始:</p> <p># JSGF V1.0<br/>语法 goforward<br/>公共&lt;移动&gt; =前进&lt;方向&gt; &lt;距离&gt;【米|米】；<br/> &lt;方向&gt; =向前|向后；<br/> =(一|二|三|四|五|六|七|八|九|十|二十)+；</p> <p>你可以看到它可以指定替代，重复和跳过。JSGF 基本上描述了识别器的有限状态自动化。你的语法越严格，识别的准确性就越好。但是不要忘记在真正的语法中包括所有那些填充符<br/>和错误的开始。用户不会对设备说</p> <p>"意大利香肠披萨"</p> <p>他们会说</p> <p>“我想让我想想……三个意大利辣香肠比萨饼，不……加洋葱”</p> <p>你的语法应该涵盖这一点。一旦你创建了你的语法，将其存储为<br/> grammar.jsgf。另外，以 16khz 单声道录制音频文件，并将其命名为“myrecording.wav”。</p> <p>现在，让我们做一些编程。为了演示如何创建语音识别应用程序，让我们首先尝试将 Pocketsphinx 与 Python 结合使用。Python API 非常简单，示例只有 6 行代码。要识别语音，你需要完成三个步骤，它们是:</p> <p>#!/usr/bin/python</p> <p>#第一步，初始化<br/>导入 pocketsphinx 为 ps <br/>解码器= ps。解码器(jsgf = '/path/to/your/jsgf/grammar . jsgf '，samp rate = ' 8000 ')<br/>#第二步，打开音频文件。<br/> fh = open("myrecording.wav "，" Rb ")<br/>nsamp = decoder . decode _ raw(FH)<br/>#第三步，获取结果<br/> hyp，uttid，score = decoder . get _ hyp()<br/>print " Got result % s % d " %(hyp，score)</p> <p>现在，让我们用 c 做同样的事情。它与 python 并没有真正的不同，只是更适合你的设备。</p> <p>#包括<pocketsphinx.h/></p> <p>int <br/> main(int argc，char * argv[])<br/>{<br/>PS _ decoder _ t * PS；<br/>cmd _ ln _ t * config；<br/>FILE * FH；<br/> char const *hyp，* uttid<br/>int 16 buf[512]；<br/>int RV；<br/> int32 评分；</p> <p>/*配置的初始化*/ <br/> config = cmd_ln_init(NULL，ps_args()，TRUE，<br/> "-samprate "，" 8000 "，<br/> "-jsgf "，" test.jsgf "，<br/>NULL)；<br/>PS = PS _ init(config)；</p> <p>/*打开音频文件，开始馈入解码器*/<br/>FH = fopen(" my recording . wav "，" Rb ")；<br/> rv = ps_start_utt(ps，" go forward ")；<br/> while(！feof(FH)){<br/>size _ t nsamp；<br/> nsamp = fread(buf，2512，FH)；<br/> rv = ps_process_raw(ps，buf，nsamp，FALSE，FALSE)；<br/>}<br/>RV = PS _ end _ utt(PS)；</p> <p>/*获取结果并打印*/ <br/> hyp = ps_get_hyp(ps，&amp; score，&amp;uttid)；<br/> if (hyp == NULL) <br/>返回 1；<br/> printf("已识别:%s with prob %d\n "，hyp，ps_get_prob (ps，NULL))；</p> <p>/* Free the stuff */<br/>f close(FH)；<br/>PS _ free(PS)；<br/>返回 0；<br/> }</p> <p>在 Linux 上，用简单的命令行编译演示:</p> <p>gcc ' pkg-config pocket sphinx–cflags–libs ' demo . c-o demo</p> <p>然后跑</p> <p>。/演示</p> <p>如果有效，它就可以被包含到您的设备中。阅读 API 指南中关于 Pocketsphinx 函数<br/>的更多信息:</p> <p><a href="http://cmusphinx.sourceforge.net/api/pocketsphinx/" rel="nofollow" target="_blank">http://cmusphinx.sourceforge.net/api/pocketsphinx/</a></p> <p>完成基本示例后，就该使用 Pocketsphinx 构建应用程序了。当你设计它的时候，解放你的思想，不要只关注像“开灯”这样简单的命令。现代应用包括智能逻辑分析、连续听写支持和许多其他东西。尝试变得合理，设计你的界面和语法，考虑用户和你的演讲<br/>应用将会成功。</p> <p>还是不相信能行？观看此视频<a href="http://www.youtube.com/watch?v=OEUeJb6Pwt4" rel="nofollow" target="_blank">http://www.youtube.com/watch?v=OEUeJb6Pwt4</a><br/>演示在诺基亚 N800 上运行的 pocketsphinx。有关 Pocketsphinx、CMUSphinx 项目、语音识别的更多详情，请访问<a href="http://cmusphinx.sourceforge.net" rel="nofollow" target="_blank">http://cmusphinx.sourceforge.net</a></p> </div> </body> </html>