# 器件:133MHz-16.2kHz 可编程振荡器(DS1077)

> 原文：<https://hackaday.com/2008/11/28/parts-133mhz-162khz-programmable-oscillator-ds1077/>

![cover](img/cf4d98d70e48deaeb9d588a6eea29001.png "cover")

[DS1077](http://www.maxim-ic.com/quick_view2.cfm/qv_pk/3359) 是一个 5v、133MHz 至 16kHz 可编程时钟源。内部分频器通过简单的 I2C 接口配置，芯片不需要外部器件。不到 2 美元就不错了。在项目中使用之前，我们用[总线盗版](http://hackaday.com/2008/11/19/how-to-the-bus-pirate-universal-serial-interface)来测试这个芯片。获取[数据表](http://datasheets.maxim-ic.com/en/ds/DS1077.pdf) (PDF)并跟随。

**[DS1077](https://shop.maxim-ic.com/storefront/priceavailable.do?Partnumber=DS1077Z-133%2B&event=PartSearch&menuitem=PriceAndAvailability) ，1.69 美元直接从美心+10 美元运费。**

这种芯片还没有在任何主要经销商处出售，但 Maxim 以不到 2 美元/个的价格出售，运费固定为 10 美元。这是一个 8 针 SOIC 表面贴装芯片，所以我们做了一个小分线板进行测试。

*测试电路*

![schematic-450](img/9e26be203fe6482ea9ee82dea5c6c57f.png "schematic-450")

*引脚连接*

| **公交车海盗** | **ds 1077
销** |
| SCL | SCL (8) |
| 国家药品监督管理局 | 民主行动党(7) |
| 去吧 | 输出 1 (1) |
| +5 伏 | Vcc (3) |
| GND | 全球导航卫星系统，CTRL 键(4.5.6) |

我们从 Bus Pirate 的 5 伏电源为 DS1077 供电。两个电阻，R1 和 R2，[在不使用时将 I2C 总线上拉至 5v。根据数据手册的建议，电容 C1 为 0.01uF，C2 为 0.1uF。控制引脚提供一些额外功能，但我们在测试中将其旁路至地。Output1 是主时钟信号引脚。](http://en.wikipedia.org/wiki/Pull-up_resistor)

*接口*

| **地址** | **目的** |
| 0b10110000 | 默认基址(0xB0) |
| 0xB0 | 写地址 |
| 0xB1 | 读取地址 |

我们把巴士海盗进入 I2C 模式(M，选项:I2C，100kHz)。外部上拉电阻将总线保持在 5v，因此必须保持板上 3.3v 上拉电阻关闭(默认)。

> I2C > { 0b 10110000 }**<–ds 1077 写地址**
> 210 I2C 开始条件
> 220 I2C 写:0xB0 得到 ACK:是**<–得到 ACK**
> 240 I2C 停止条件
> I2C >

首先，我们广播 DS1077 的地址，看它是否应答。DS1077 的地址是 1011，加上三个可编程位(默认为 000)，以及读(1)或写(0)位。我们收到了 ACK，所以我们知道电路正在工作，我们的连接是好的。

| **地址** | **字节** | **寄存器** |
| 0x01 | Two | 10 位时钟分频器，n+2(分频) |
| 0x02 | Two | 预分频器、CTRL 引脚功能。(多路复用器) |
| 0x0D | one | 地址选择，EEPROM 写控制。(公共汽车) |
| 0x3F | Zero | 将设置保存到 EEPROM (E2) |

DS1077 通过将值写入表中所示的位置来控制。

> I2C>{0xb0 0x0d 0b00001000}，**<–写入总线寄存器**
> 210 I2C 起始条件
> 220 I2C 写入:0xb0 得到 ACK:是**<–ds 1077 写入地址**
> 220 I2C 写入:0x0d 得到 ACK:是**<–总线寄存器**
> 220 I2C 写入:0x08 得到 ACK:是**<–总线寄存器**

默认情况下，DS1077 会将所有更改保存到 EEPROM。测试期间我们不需要它，因此我们通过设置总线寄存器(0x0d)的位 3 (0b1000)来禁用它。前四位必须保留为 0，后三位选择地址，以便在同一 I2C 总线上容纳多个 DS1077s。参见数据手册第 7 页。

> I2C > { 0xb0 0x02 0b 00011000 0b 00000000 }**<–设置 16 位 MUX 值**
> 210 I2C 起始条件
> 220 I2C 写:0xb 0 得到 ACK:是**–ds 1077 写地址**
> 220 I2C 写:0x 02 得到 ACK:是**<–MUX 寄存器**
> 220 I2C 写:0x18 得到 ACK:

MUX 寄存器控制预分频器、CTRL 引脚功能和分频器。我们禁用预分频器和 CTRL 引脚，并使能 10 位分频器。数据手册第 5 页解释了 MUX 寄存器。

特定频率通过预分频器和 10 位(1025 级)可编程分频器对 133MHz 参考频率进行分频而产生。时钟除以 DIV 寄存器中指定的数量，*加上两个*。当 DIV=0 时，输出为 133MHz/2=66MHz。

![graph](img/0ca36c89d0bea42da1ca55330f06d114.png "graph")

该方案在低频范围内提供最佳频率分辨率，133MHz 至 66MHz 之间无阶跃。

> I2C > { 0xb 0 1 0b 1111111 0b 11000000 } **<–DIV = 1025**
> 210 I2C 起始条件
> 220 I2C 写:0xB0 得到 ACK:是**<–ds 1077 写地址**
> 220 I2C 写:0x01 得到 ACK:是**<–DIV 寄存器**
> 220 I2C 写:0xFF 得到 ACK:是**<–位 9:2**
> 220 I2C 写:0xC0

为了实现最大分频，我们将 DIV 寄存器中的所有位都设置为 1。f '测量 AUX 引脚上的频率，该引脚连接到 DS1077 时钟输出。当 DIV=1025 时，频率约为 16kHz。

> I2C > { 0xb 0 1 0 }**<–DIV = 0，133MHz 除以 2**
> ……
> 9xx FREQ 计数上 AUX:0Hz**<–66 MHz，快数不过来**
> 
> **——————** 
> 
> I2C > { 0 XB 0 1 0 0 b 100000000 }<–div = 2
> 
> 9xx 频率计数 au:339696hz(33 MHz)**<–133 MHz/4**
> 
> **——————** 
> 
> I2C > { 0 XB 0 1 0 b 00000001 0 b 00000000 }<【div = 4】
> 
> 9xx 频率计数 au:22192384hz(22 MHz)**<–133 MHz/6**

我们可以用分频器产生一系列频率。输出始终等于参考频率(133MHz)除以 DIV+2。总线盗版的输入引脚只能测量约 50 兆赫，所以最高速度不登记。未来版本的总线盗版应该包括一个千兆赫预分频器，用于高频测量。

> I2C > { 0xb 0 0x3f }**<–写入 E2 寄存器**

最后，我们可以写入 E2 寄存器(0x3f ),将这些设置保存在 EEPROM 中。DS1077 现在将在通电时返回到这些设置。

**结论**

DS1077 将可编程振荡器和分频器集成到单芯片中，简化了复杂的时钟源。经销商处没有，但你可以直接从 Maxim 购买。如果您需要更好地控制高频，请查看从 133MHz 到 8kHz 步进为 10kHz 的 [DS1085](http://www.maxim-ic.com/quick_view2.cfm/qv_pk/3491) 。DS1085L 是一款 3.3 伏、66 兆赫版本的[，可在 Digikey](http://search.digikey.com/scripts/DkSearch/dksus.dll?Detail?name=DS1085LZ-25%2B-ND) 买到。

![bread-450](img/5dedd73484fd4e4595b799b6f0d95e75.png "bread-450")