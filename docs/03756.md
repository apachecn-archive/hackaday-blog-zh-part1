# 黑帽 2009:电力线和光密钥加密

> 原文：<https://hackaday.com/2009/07/29/black-hat-2009-powerline-and-optical-keysniffing/>

![sniff](img/14269f1e2e2970e94cf41290162e84b6.png "sniff")

2009 年拉斯维加斯黑帽安全会议才刚刚开始。我们看到的第一个有趣的演讲是[Andrea Barisani]和[Daniele Bianco]的[用激光/电压表嗅击键](http://dev.inversepath.com/download/tempest "Index of /download/tempest/")。他们提出了两种对键盘进行暴风雨式窃听的方法。

第一次攻击是针对 PS/2 键盘。在 PS/2 线缆内部，数据线没有很好地与地线屏蔽，因此所有数据最终都可能被传输回建筑物的电气接地。与计算机生成的其他信号相比，时钟信号也非常慢。在 10-16.7kHz 左右，应该很容易采样并滤除背景噪声。他们决定在距离有问题的键盘 20 米的插座上监听地线。他们在电气接地和参考接地之间使用了大约 150 欧姆的电阻。参考地是建筑的管道，用于确定电气接地中的实际噪声。他们测量了电阻上的压降，并使用有限脉冲响应作为 1-20kHz 的带通滤波器。他们很容易就能接收到键盘的信号。它工作得非常好，以至于他们建立了一个远程监控板，使用 AVR ATxmega128A1 进行采样并通过以太网发送数据。最后，他们指出，USB 使用差分信号传输，这应该可以消除任何泄漏，但处理器更加密集，最终可能很容易拾取。他们还表示，许多自动取款机可能使用 PS/2 风格的键盘泄漏这些信息。

在他们谈话的第二部分，他们谈到了使用激光来收集击键。他们将激光对准笔记本电脑盖子的背面，记录下产生的振动，就像普通的激光麦克风一样(离铰链越近，信号越清晰)。他们注意到的第一件事是，空格键体积较大，产生了一个非常独特的信号，比所有其他信号都大得多。他们利用这些信息来确定单词断在哪里。通过使用动态时间弯曲将捕获的波形相互比较，他们可以确定字母模式。然后他们将这些序列与字典结合使用，找出哪些单词具有相同的模式，并且按照相同的顺序有意义。它运行得很好，他们说如果你能猜出上下文，它会运行得更快。他们提到笔记本电脑盖子上的标志非常反光，即使在白天和透过玻璃也能很好地工作。

你可以在他们的网站上找到[白皮书和示例代码。](http://dev.inversepath.com/download/tempest "Index of /download/tempest/")