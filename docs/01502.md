# ToorCon 9:真实世界模糊化

> 原文:[https://hack aday . com/2007/10/20/toorcon-9-real-world-fuzzing/](https://hackaday.com/2007/10/20/toorcon-9-real-world-fuzzing/)

昨天快结束的时候，我们顺便去听了查理·米勒在 T2 的研讨会。模糊化在去年成为一个相当流行的话题，本质上是给一个程序垃圾输入，希望它会崩溃。如果它不能处理假数据并以一种不优雅的方式失败，您可能已经发现了一个潜在的可利用的 bug。Fuzzing 是一个相当简单的想法，但正如查理指出的，如果你在做的时候没有一些思考，它不太可能是非常富有成效的。

假设你想模糊一个 PDF 阅读器。你拿一个随机的好的 PDF 文件，然后用一个模糊化的程序遍历这个文件的多个变异。这就带来了一个问题，你多久模糊一件事？你让它 24 小时运行，时间够吗？Charlie 应用[代码覆盖](http://en.wikipedia.org/wiki/Code_coverage)的原则来确定他的 fuzzing 实际测试了多少代码。他以 PNG 库为例。他随机选择了一个 PNG 进行变异，并测试了一小部分代码。在研究 PNG 规范时，他发现一个 PNG 文件中可能有 21 种不同的块类型，所以他随机抽取了 1600 个 PNG，并从中变异出来。这些不同的种子文件给了他更多的代码覆盖率，因为这些文件包含了几乎所有不同的块类型。基本思想是，如果你不执行一行代码，你永远也不会在那行代码中发现错误。

查理是发现第一个 iPhone 漏洞的团队成员之一。他们使用代码覆盖率来确定从哪里开始工作。苹果的 WebKit 是开源的，有一个说明说使用 Mozilla 的测试套件来测试 JavaScript 核心的修改。使用 gcov，它是 gcc 的一部分，他们对代码进行了测试。该工具显示了测试套件执行了哪些代码。他们忽略了那些代码，开始研究他们发现的大量未测试的代码，因为这些代码更有可能包含 bug。他们在那里找到了最终被利用的 Perl RegEx 解析器。

这不仅仅是针对有源代码的程序；你也可以使用代码覆盖工具，比如 Pei Mei 和 IDA Pro 来确定你要找的特定代码位于二进制文件的哪个部分。然后，您可以编写更智能的生成器来处理更多的特定代码。