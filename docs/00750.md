# Shmoocon 2006:使用沙网的行为恶意软件分析

> 原文:[https://hack aday . com/2006/01/27/shmoocon-2006-行为-恶意软件-分析-使用-sandnets/](https://hackaday.com/2006/01/27/shmoocon-2006-behavioral-malware-analysis-using-sandnets/)

![sandnet](../Images/844830e3eab5a85d157e297c4aef69af.png)

分析恶意软件的一种常见方法是在 [VMware](http://www.vmware.com/) 会话中将其释放，但一些恶意软件有检测虚拟机的方法，如果遇到虚拟机，将拒绝运行。乔·斯图尔特开发了一种叫做[楚门](http://www.lurhq.com/truman/)的工具，可以用来构建沙网。sandnet 扩展了将 VMware 用作沙箱的想法。该恶意软件运行在正常的操作系统环境中，而不是虚拟环境中，它与它认为是整个网络的东西进行交互。

设置是这样工作的:您有两台使用交叉网线连接的机器。机器 1 是服务器，机器 2 是运行恶意软件的客户端。机器 2 通过 [PXE](http://en.wikipedia.org/wiki/Preboot_Execution_Environment) 引导到一个干净的 Windows 安装中(或者你的恶意软件针对的任何操作系统)。一旦启动，它开始监视恶意软件的 exe 文件在服务器上的目录。一旦将可执行文件复制到目录中，Windows 机器就会复制文件并执行它。10 分钟后，Windows 机器将其物理内存转储到磁盘，然后关机。然后保存新感染的 Windows 文件系统的映像。然后，客户机启动到 Linux，分析新的 Windows 映像。Truman 提高了分析速度，因为您不必经常手动重新映像客户机。

PXE 服务器也充当客户端机器的 fauxinternet。通过观察 tcpdump，您可以看到恶意软件试图建立什么出站连接。为了帮助这一过程，Truman 包含了几个 fauxservers，它们只是简单的 Perl 脚本，被设计成充当服务器。fauxservers 会准确地告诉恶意软件它想听到的内容，希望它能说出登录名、密码和其他有用的信息。

*   [永久链接](http://www.lurhq.com/truman/)