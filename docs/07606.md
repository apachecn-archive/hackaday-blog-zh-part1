# 优化代码以提高 PWM 效率

> 原文:[https://hack aday . com/2011/05/14/optimizing-code-for-PWM-efficiency/](https://hackaday.com/2011/05/14/optimizing-code-for-pwm-efficiency/)

![](../Images/5502ea49560fcc696cb822a593857de5.png "Code")

对于一些项目来说，让微控制器大部分时间摆弄它的拇指是没问题的。当一个项目需要 cpu 一遍又一遍地做一件事情时，低效率的代码没有任何损失——它要么工作，要么不工作。然而，如果一个项目需要一个微控制器同时做几件事，如读取传感器、调暗 led 和写出串行数据，cpu 利用率就会成为一个问题。[罗伯特]对他用来控制一串发光二极管的代码不满意，所以他[重写了他的代码](http://blog.spitzenpfeil.org/wordpress/2011/02/20/pwm-again/)。在旧的实现中，[Robert]的代码占用了 60%的 cpu 时间。有了新的和改进的代码，cpu 只有 8%的时间是忙碌的。

该代码通过使用硬件定时器触发中断来工作。在计算下一次它应该再次运行，并改变数据线的状态后，代码只是静静地坐着，直到它再次被需要。

这不是一个漂亮的黑客，甚至不是一个你可以拿在手中的黑客，但[罗伯特]让μC 做他想做的事情的决心令人钦佩。